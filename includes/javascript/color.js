if(typeof HTMLElement!="undefined"&&!HTMLElement.prototype.insertAdjacentElement){HTMLElement.prototype.insertAdjacentElement=function(A,B){switch(A){case"beforeBegin":this.parentNode.insertBefore(B,this);break;case"afterBegin":this.insertBefore(B,this.firstChild);break;case"beforeEnd":this.appendChild(B);break;case"afterEnd":if(this.nextSibling){this.parentNode.insertBefore(B,this.nextSibling)}else{this.parentNode.appendChild(B)}break}};HTMLElement.prototype.insertAdjacentHTML=function(B,D){var C=this.ownerDocument.createRange();C.setStartBefore(this);var A=C.createContextualFragment(D);this.insertAdjacentElement(B,A)};HTMLElement.prototype.insertAdjacentText=function(B,C){var A=document.createTextNode(C);this.insertAdjacentElement(B,A)}}function allselect(){var A=document.getElementsByTagName("input");for(i=0;i<A.length;i++){if(A[i].type=="checkbox"){A[i].checked=true}}};
Colors=function(objectId,inputTextId,styleColor,pallete){this._object=document.getElementById(objectId);this._objectId=objectId;this.inputText=document.getElementById(inputTextId);this.inputTextId=inputTextId;this.styleColor=styleColor;eval("this.oldColor = Colors.rgb2hex(this._object.style."+styleColor+")");this.inputText.value="#"+this.oldColor;this.pallete=pallete};Colors.prototype.show=function(){var a='<span id="allcolorselementsselect'+this.inputTextId+'" onclick="document.getElementById(\'allcolorselements'+this.inputTextId+"').style.display='block'; document.getElementById('allcolorselementslink"+this.inputTextId+'\').focus();" style="cursor: pointer;"><img src="'+this.outImage+'" title="Case Color" style="position:relative; top:2px; left: 2px;" onmouseover="this.src=\''+this.overImage+"'\" onmouseout=\"this.src='"+this.outImage+"'\" /></span>";a+='<input id="setc'+this.inputTextId+'" type="hidden" value="0" />';a+='<input id="oldColor'+this.inputTextId+'" type="hidden" value="#'+this.oldColor+'" />';a+='<a id="allcolorselementslink'+this.inputTextId+'" href="#" onclick="return false;" onblur="document.getElementById(\'allcolorselements'+this.inputTextId+"').style.display='none'; if (document.getElementById('setc"+this.inputTextId+"').value!='1') Colors.changecolor(document.getElementById('oldColor"+this.inputTextId+"').value, '"+this._objectId+"', '"+this.inputTextId+"', '"+this.styleColor+"'); document.getElementById('setc"+this.inputTextId+"').value='0'; \">";a+='<div id="allcolorselements'+this.inputTextId+'" style="width: '+this.allwidth+'px; cursor: pointer; display: none; position: absolute; z-index:1000; background-color:#bbb; border:solid 1px #bbb;">';for(var b=1,c=0;b<=this.rows;b++){for(var d=1;d<=this.cols;d++){a+='<div style="background:'+this.pallete[c++]+"; float:left; width:"+this.width+"px; height:"+this.width+"px; margin:"+this.border+"px; border:solid "+this.border+'px #000;" onmousedown="document.getElementById(\'setc'+this.inputTextId+"').value='1'; document.getElementById('oldColor"+this.inputTextId+"').value=this.style.backgroundColor;\" onmousemove=\"Colors.changecolor(this.style.backgroundColor, '"+this._objectId+"', '"+this.inputTextId+"', '"+this.styleColor+"');\" onmouseover=\"this.style.border='solid "+this.border+"px #ffff00'\" onmouseout=\"this.style.border='solid "+this.border+"px #000';\"></div>"}a+='<div style="clear:both;"></div>'}a+="</div></a>";document.getElementById(this.inputTextId).insertAdjacentHTML("afterEnd",a)};Colors.rgb2hex=function(a){if(!a)return"000000";if(a.substring(0,1)=="#")return a.substring(1);else{var b,c,d="",e="0123456789abcdef";var f=a.substring(4);f=f.substring(0,f.length-1);if(f){b=f.split(",");for(c=0;c<3;c++){n=parseInt(b[c]);d+=e.charAt(n>>4)+e.charAt(n&15)}return d}}};Colors.changecolor=function(thiscolor,_object,inputText,styleColor){eval("document.getElementById(_object).style."+styleColor+" = thiscolor");document.getElementById(inputText).value="#"+Colors.rgb2hex(thiscolor)};Colors.setup=function(a){function b(b,c){if(typeof a[b]=="undefined"){a[b]=c}}b("rows",5);b("cols",12);b("width",20);b("border",1);b("styleColor","color");b("inputTextId",null);b("objectId",null);b("pallete",new Array("#FFFFCC","#FFFF66","#FFCC66","#F2984C","#E1771E","#B47B10","#A9501B","#6F3C1B","#804000","#CC0000","#940F04","#660000","#C3D9FF","#99C9FF","#66B5FF","#3D81EE","#0066CC","#6C82B5","#32527A","#2D6E89","#006699","#215670","#003366","#000033","#CAF99B","#80FF00","#00FF80","#78B749","#2BA94F","#38B63C","#0D8F63","#2D8930","#1B703A","#11593C","#063E3F","#002E3F","#FFBBE8","#E895CC","#FF6FCF","#C94093","#9D1961","#800040","#800080","#72179D","#6728B2","#6131BD","#341473","#400058","#FFFFFF","#E6E6E6","#CCCCCC","#B3B3B3","#999999","#808080","#7F7F7F","#666666","#4C4C4C","#333333","#191919","#000000"));b("outImage","rgb.gif");b("overImage","on_rgb.gif");var c=new Colors(a.objectId,a.inputTextId,a.styleColor,a.pallete);c.rows=a.rows;c.cols=a.cols;c.width=a.width;c.border=a.border;c.allwidth=c.cols*(c.width+c.border*4)+c.border;c.outImage=a.outImage;c.overImage=a.overImage;c.show();return c}